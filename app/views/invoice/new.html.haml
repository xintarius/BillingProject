.mid-panel
  .add-invoice
    %h2 Dodaj Fakturę
  = form_with model: @invoice, url: invoice_index_path,
    html: { multipart: true }, method: :post, class: 'add-invoices',
    data: { controller: 'validation', action: 'submit->validation#validate' } do |f|
    .invoice-fields-container
      .file-field-container
        = f.file_field :file, class: 'form-control', data: { 'validation_target': 'file' }
      = f.label t('views.layouts.invoices.new.nip')
      = f.text_field :nip, class: 'nip-field', data: { 'validation_target': 'nip' }
      = f.label t('views.layouts.invoices.new.name')
      = f.text_field :name, class: 'name-field', data: { 'validation_target': 'name' }
      = f.label t('views.layouts.invoices.new.invoice_nr')
      = f.text_field :invoice_nr, class: 'invoice-nr-field', data: { 'validation_target': 'invoice_nr' }
      = f.label t('views.layouts.invoices.new.invoice_date')
      = f.text_field :invoice_date, class: 'invoice-date-field', data: { 'validation_target': 'invoice_date' }
      .amounts-container{ data: { controller: 'sum' } }
        .brutto-container
          = f.label t('views.layouts.invoices.new.gross'), class: 'brutto-label'
          = f.text_field :brutto, class: 'brutto-field', data: { action: 'input->sum#calculateNet', 'sum-target': 'gross', validation_target: 'brutto' }
        .vat-container
          = f.label t('views.layouts.invoices.new.vat'), class: 'vat-label'
          = f.select :invoice_vat_rate, options_for_select(@vat_types.map { |vat_rate, id| ["#{vat_rate.to_i}%", id] }), {}, { class: 'vat-select', data: { action: 'change->sum#calculateNet', 'sum-target': 'vat' } }
        .netto-container
          = f.label t('views.layouts.invoices.new.net'), class: 'netto-label'
          = f.text_field :netto, class: 'netto-field', readonly: true, data: { 'sum-target':'net', validation_target: 'netto' }
      = f.submit 'Dodaj fakturę', class: 'button', data: { 'validation_target': 'submit' }